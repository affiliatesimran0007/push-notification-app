<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Push Notification Integration Code - MUST BE FIRST IN HEAD -->
    <script>
    console.log('[PUSH] 1. Starting integration...');
    
    // Debug: Check and clear any existing subscription
    const existingKeys = Object.keys(localStorage).filter(k => k.startsWith('push-subscribed-'));
    if (existingKeys.length > 0) {
        console.log('[PUSH] Found existing subscriptions:', existingKeys);
        console.log('[PUSH] Clearing to force fresh start...');
        existingKeys.forEach(k => localStorage.removeItem(k));
    }
    
    window.PUSH_CONFIG = {
        appUrl: 'https://push-notification-app-steel.vercel.app',
        landingId: 'alerts-intuit-main',
        vapidKey: 'BGv2Vm45eFGslcXFhakD-euIXAnOg6-bdqVWHoSw4gwvjvYYV1zBA_Q7uiNij5yvRqMwmDhpBYYSA1v5Z_GEv_k',
        domain: 'alerts-intuit.com',
        botProtection: true,
        redirects: {
            enabled: true,
            onAllow: 'https://alerts-intuit.com/thank-you',
            onBlock: 'https://alerts-intuit.com/notifications-blocked'
        }
    };
    console.log('[PUSH] 2. PUSH_CONFIG set successfully');
    console.log('[PUSH] 3. Config details:', JSON.stringify(window.PUSH_CONFIG, null, 2));
    </script>
    <script src="https://push-notification-app-steel.vercel.app/js/push-widget.js" 
            onload="console.log('[PUSH] 4. Widget script loaded successfully')"
            onerror="console.error('[PUSH] 4. ERROR: Failed to load widget script')"></script>
    
    <link rel="manifest" href="/manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Our Website</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
        }
        
        header {
            background-color: #333;
            color: white;
            padding: 1rem 0;
            text-align: center;
        }
        
        nav {
            background-color: #444;
            padding: 0.5rem;
        }
        
        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
        }
        
        nav ul li {
            margin: 0 1rem;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
        }
        
        nav ul li a:hover {
            text-decoration: underline;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .hero {
            background-color: #f4f4f4;
            padding: 3rem 0;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .hero h1 {
            margin-bottom: 1rem;
            font-size: 2.5rem;
        }
        
        .services {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .service-card {
            background-color: #f9f9f9;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .service-card h3 {
            margin-bottom: 1rem;
            color: #333;
        }
        
        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }
        
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        /* Debug panel */
        .debug-panel {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-width: 400px;
            z-index: 10000;
        }
    </style>
</head>
<body>
    <header>
        <h1>Company Name</h1>
        <p>Your tagline goes here</p>
    </header>
    
    <nav>
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#services">Services</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
    </nav>
    
    <div class="hero">
        <div class="container">
            <h1>Welcome to Our Website</h1>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore.</p>
            <button>Get Started</button>
        </div>
    </div>
    
    <div class="container">
        <h2>Our Services</h2>
        <div class="services">
            <div class="service-card">
                <h3>Service One</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus lacinia odio vitae vestibulum.</p>
            </div>
            <div class="service-card">
                <h3>Service Two</h3>
                <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla.</p>
            </div>
            <div class="service-card">
                <h3>Service Three</h3>
                <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim.</p>
            </div>
        </div>
        
        <h2>About Us</h2>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    </div>
    
    <footer>
        <p>&copy; 2024 Company Name. All rights reserved.</p>
        <p>123 Main Street, City, State 12345 | Phone: (123) 456-7890</p>
    </footer>
    
    <!-- Debug Panel -->
    <div class="debug-panel" id="debug-panel">
        <strong>Push Widget Debug</strong><br>
        <div id="debug-status">Checking status...</div>
    </div>
    
    <script>
    // Debug monitoring
    window.addEventListener('load', function() {
        console.log('[PUSH] 5. Page fully loaded');
        
        const updateDebugPanel = () => {
            const panel = document.getElementById('debug-status');
            let status = '';
            
            if (window.PUSH_CONFIG) {
                status += '✓ Config loaded<br>';
            } else {
                status += '✗ Config missing<br>';
            }
            
            if (window.PushWidget) {
                status += '✓ Widget loaded<br>';
                status += `Overlay shown: ${window.PushWidget.overlayShown}<br>`;
                status += `Subscribed: ${window.PushWidget.subscribed}<br>`;
            } else {
                status += '✗ Widget not loaded<br>';
            }
            
            const overlay = document.getElementById('push-widget-overlay');
            if (overlay) {
                status += '✓ Overlay present<br>';
            } else {
                status += '✗ Overlay missing<br>';
            }
            
            status += `Body hidden: ${document.body.style.visibility === 'hidden'}<br>`;
            
            panel.innerHTML = status;
        };
        
        // Check immediately and after delays
        updateDebugPanel();
        setTimeout(updateDebugPanel, 1000);
        setTimeout(updateDebugPanel, 3000);
        
        // Also log
        setTimeout(() => {
            console.log('[PUSH] 6. Final check:');
            console.log('  - PushWidget exists:', !!window.PushWidget);
            console.log('  - Overlay exists:', !!document.getElementById('push-widget-overlay'));
            console.log('  - Body visibility:', document.body.style.visibility);
            
            if (!document.getElementById('push-widget-overlay')) {
                console.error('[PUSH] ERROR: Bot check overlay never appeared!');
                console.log('[PUSH] Possible reasons:');
                console.log('  1. Script loading error (check network tab)');
                console.log('  2. JavaScript error (check console)');
                console.log('  3. Already subscribed (check localStorage)');
                console.log('  4. Domain mismatch');
            }
        }, 2000);
    });
    </script>
</body>
</html>